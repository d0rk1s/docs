---
title: "Agendar Nueva Cita"
description: "Paso a paso para crear una cita manualmente desde el panel de administraci√≥n"
---

# Agendar Nueva Cita Manualmente

Esta gu√≠a te muestra c√≥mo crear una cita manualmente desde el panel de administraci√≥n. √ösala cuando los pacientes llamen por tel√©fono, vengan en persona, o cuando necesites agendar con anticipaci√≥n.

## ¬øCu√°ndo Usar Creaci√≥n Manual?

<CardGroup cols={2}>
  <Card title="Creaci√≥n Manual" icon="user" color="#0D9373">
    **√ösala cuando:**
    - Paciente llama por tel√©fono
    - Paciente viene en persona
    - Necesitas agendar con anticipaci√≥n
    - El paciente no usa WhatsApp
  </Card>
  <Card title="WhatsApp Autom√°tico" icon="message" color="#25D366">
    **√ösalo cuando:**
    - Paciente prefiere WhatsApp
    - Fuera de horario laboral (24/7)
    - No tienes tiempo para agendar
    - Paciente quiere autoservicio
  </Card>
</CardGroup>

<Note>
El bot de WhatsApp puede agendar citas autom√°ticamente 24/7 sin intervenci√≥n humana. M√°s info en [Conversaciones WhatsApp](/whatsapp/overview).
</Note>

---

## Paso a Paso

<Frame>
  <img src="/images/screenshots/appointments_create_02_form_empty.png" alt="Formulario de nueva cita vac√≠o" />
</Frame>

<Steps>
  <Step title="Abrir el Formulario de Nueva Cita">
    Hay dos formas de abrir el formulario:

    **Opci√≥n 1: Desde el Calendario**
    1. Navega a **Citas** en el men√∫ lateral
    2. Click en el bot√≥n **"Nueva Cita"** o **"+"** en la esquina superior derecha
    3. Se abrir√° el formulario modal

    <Frame>
      <img src="/images/screenshots/appointments_create_01_button.png" alt="Bot√≥n de nueva cita en el calendario" />
    </Frame>

    **Opci√≥n 2: Desde el Men√∫ Principal**
    1. Click en **Citas** > **Nueva Cita** en el men√∫ lateral
    2. Se abrir√° directamente el formulario

    <Tip>
    Si haces click en un d√≠a/hora espec√≠fica del calendario, esa fecha/hora se pre-selecciona autom√°ticamente en el formulario.
    </Tip>
  </Step>

  <Step title="Seleccionar el Servicio">
    El primer paso es elegir qu√© servicio prestar√° la cl√≠nica al paciente.

    1. Click en el dropdown **"Servicio"**
    2. Selecciona el servicio de la lista (ej: "Corte de pelo", "Consulta m√©dica", "Tinte")
    3. La **duraci√≥n se calcula autom√°ticamente** seg√∫n la configuraci√≥n del servicio

    <Frame>
      <img src="/images/screenshots/appointments_create_03_service_select.png" alt="Selecci√≥n de servicio en el dropdown" />
    </Frame>

    <Tip>
    Si no ves el servicio que necesitas, cr√©alo primero en **Cat√°logo** > **Servicios**.

    [Ver c√≥mo crear servicios](/services/create-service)
    </Tip>

    <Info>
    **Ejemplo**: Si seleccionas "Corte de pelo" (30 min), el sistema autom√°ticamente reservar√° 30 minutos en el calendario.
    </Info>
  </Step>

  <Step title="Seleccionar el Proveedor (Opcional)">
    Elige qui√©n atender√° al paciente. Este paso es **opcional**.

    **Si seleccionas un proveedor espec√≠fico:**
    - Solo ver√°s slots disponibles de ese proveedor
    - La cita se asigna directamente a ese profesional

    **Si NO seleccionas proveedor:**
    - El sistema muestra slots de TODOS los proveedores disponibles
    - El sistema asigna autom√°ticamente seg√∫n disponibilidad
    - √ötil cuando cualquier profesional puede prestar el servicio

    <Frame>
      <img src="/images/screenshots/appointments_create_04_provider_select.png" alt="Selecci√≥n de proveedor" />
    </Frame>

    <Note>
    La asignaci√≥n autom√°tica busca el primer proveedor disponible que pueda prestar el servicio en el horario solicitado.
    </Note>

    <Tip>
    Si tienes proveedores especializados (ej: "Doctora P√©rez" solo hace cirug√≠as), es mejor seleccionarlo manualmente para evitar asignaciones incorrectas.
    </Tip>
  </Step>

  <Step title="Seleccionar Fecha y Hora">
    Ahora elige cu√°ndo se realizar√° la cita.

    ### Seleccionar la Fecha

    1. Click en el campo **"Fecha"**
    2. Se abre un calendario
    3. Click en el d√≠a deseado
    4. El calendario se cierra autom√°ticamente

    <Frame>
      <img src="/images/screenshots/appointments_create_05_date_picker.png" alt="Calendario para seleccionar fecha con indicadores de disponibilidad" />
    </Frame>

    ### Seleccionar la Hora

    1. Despu√©s de seleccionar la fecha, ver√°s una lista de **slots disponibles**
    2. Los slots mostrados:
       - Est√°n dentro del horario de trabajo de la cl√≠nica
       - No tienen conflictos con otras citas
       - No est√°n en cierres programados (vacaciones, festivos)
       - Son del proveedor seleccionado (o de todos si no seleccionaste ninguno)
    3. Click en el slot deseado (ej: "15:00")

    <Frame>
      <img src="/images/screenshots/appointments_create_06_time_slots.png" alt="Lista de horarios disponibles con filtros por ma√±ana/tarde" />
    </Frame>

    <Warning>
    **Solo se muestran horarios libres**. Si no ves ning√∫n slot:
    - Verifica que la cl√≠nica est√© abierta ese d√≠a
    - Verifica que no haya cierres programados
    - Prueba con otra fecha u otro proveedor

    [Ver por qu√© no hay slots disponibles](#troubleshooting)
    </Warning>

    <Info>
    **Validaciones autom√°ticas** que el sistema realiza:
    - ‚úÖ Horario dentro de `work_hours` de la cl√≠nica
    - ‚úÖ No hay solapamiento con otras citas
    - ‚úÖ No hay cierres programados (`closures`)
    - ‚úÖ No hay conflictos con calendarios externos (Google Calendar, Outlook)
    </Info>

    <Tip>
    Los slots est√°n alineados con el horario de apertura de la cl√≠nica. Ej: Si la cl√≠nica abre a las 16:00, ver√°s slots a las 16:00, 16:30, 17:00 (NO 16:35, 17:05).
    </Tip>
  </Step>

  <Step title="Ingresar Datos del Paciente">
    Ahora ingresa la informaci√≥n del paciente.

    ### Nombre Completo

    1. Ingresa el nombre completo del paciente (ej: "Mar√≠a Garc√≠a L√≥pez")
    2. El sistema buscar√° autom√°ticamente si el paciente ya existe

    <Note>
    **Autocompletado inteligente**: Si el paciente ya est√° en el sistema, sus datos (tel√©fono, email) se completar√°n autom√°ticamente al escribir su nombre.
    </Note>

    ### Tel√©fono

    1. Ingresa el tel√©fono en **formato internacional** (ej: `+34612345678`)
    2. Formato: `+[c√≥digo pa√≠s][n√∫mero]`
       - Espa√±a: `+34612345678`
       - M√©xico: `+525512345678`
       - Argentina: `+5491123456789`

    <Warning>
    **Formato E.164 requerido**: El sistema solo acepta tel√©fonos en formato internacional con `+` al inicio. Si ingresas un n√∫mero sin `+`, recibir√°s un error de validaci√≥n.
    </Warning>

    <Tip>
    Si el paciente ya existe en el sistema y est√° asociado a m√∫ltiples cl√≠nicas, su nombre se actualizar√° autom√°ticamente al m√°s reciente que ingreses.

    [Ver c√≥mo funciona multi-cl√≠nica](/troubleshooting/multi-clinic-patients)
    </Tip>

    ### Email (Opcional)

    1. Ingresa el email del paciente (ej: `maria.garcia@gmail.com`)
    2. Este campo es **opcional**, pero recomendado para notificaciones

    <Info>
    **¬øPaciente nuevo vs existente?**
    - Si el tel√©fono ya existe ‚Üí se reutilizan los datos existentes
    - Si es nuevo ‚Üí se crea un registro de paciente autom√°ticamente
    </Info>
  </Step>

  <Step title="Confirmar y Crear la Cita">
    √öltimo paso: revisa y confirma.

    1. Verifica que todos los datos sean correctos:
       - ‚úÖ Servicio correcto
       - ‚úÖ Fecha y hora correctas
       - ‚úÖ Proveedor correcto (si seleccionaste uno)
       - ‚úÖ Datos del paciente correctos
    2. Click en el bot√≥n **"Agendar Cita"** o **"Crear Cita"**
    3. Espera el mensaje de confirmaci√≥n

    <Frame>
      <img src="/images/screenshots/appointments_create_08_confirmation.png" alt="Pantalla de confirmaci√≥n antes de crear la cita" />
    </Frame>

    <Tip>
    El sistema valida autom√°ticamente que:
    - No hayas alcanzado el l√≠mite de tu plan de suscripci√≥n
    - El horario siga disponible (por si alguien m√°s agend√≥ mientras completabas el formulario)
    - Todos los campos requeridos est√©n completos
    </Tip>

    ### Notificaci√≥n WhatsApp (Autom√°tica)

    Si el paciente tiene un n√∫mero de tel√©fono v√°lido y WhatsApp est√° activado:
    - **Se env√≠a autom√°ticamente** un mensaje de confirmaci√≥n por WhatsApp
    - El mensaje incluye: fecha, hora, servicio, y datos de la cl√≠nica
    - El paciente puede responder al bot para modificar o cancelar

    <Note>
    Si WhatsApp no est√° activado en tu cl√≠nica, deber√°s confirmar la cita manualmente (por llamada o mensaje).
    </Note>
  </Step>
</Steps>

---

## Resultado Final

Despu√©s de crear la cita exitosamente:

<Tabs>
  <Tab title="En el Calendario">
    - La cita aparece en el calendario en la fecha/hora seleccionada
    - El color depende del estado:
      - üü† **Naranja**: Pending (reci√©n creada)
      - üü¢ **Verde**: Confirmed (paciente confirm√≥)
  </Tab>
  <Tab title="En Lista de Citas">
    - La cita aparece en **Citas** > **Todas las Citas**
    - Estado inicial: **"Pending"**
    - Puedes cambiar el estado manualmente a "Confirmed" cuando el paciente confirme
  </Tab>
  <Tab title="Notificaciones">
    - El paciente recibe mensaje WhatsApp (si est√° activado)
    - El sistema registra la creaci√≥n en audit_logs (auditor√≠a)
    - Se actualiza el contador de citas del per√≠odo de facturaci√≥n actual
  </Tab>
</Tabs>

<Info>
**Pr√≥ximos pasos comunes**:
1. El paciente confirma ‚Üí Cambias estado a "Confirmed"
2. Llega el d√≠a de la cita ‚Üí Sistema marca autom√°ticamente como "Completed" despu√©s de la hora de fin
3. Paciente cancela ‚Üí Usas [Cancelar Cita](/appointments/cancel-appointment)
</Info>

---

## Troubleshooting

<AccordionGroup>
  <Accordion title="No veo horarios disponibles" icon="calendar-xmark">
    **Posibles causas:**

    1. **La cl√≠nica est√° cerrada ese d√≠a**
       - Verifica en **Configuraci√≥n** > **Horarios de Trabajo**
       - Si es s√°bado/domingo, verifica si hay work_hours configurados para esos d√≠as

    2. **Hay un cierre programado**
       - Verifica en **Configuraci√≥n** > **Cierres**
       - Puede haber vacaciones, festivos, o d√≠as de descanso programados

    3. **Todos los slots est√°n ocupados**
       - Prueba con otra fecha
       - Prueba con otro proveedor (si seleccionaste uno espec√≠fico)

    4. **El proveedor seleccionado no trabaja ese d√≠a**
       - Verifica en **Proveedores** > **Horarios del Proveedor**
       - Prueba con "Sin proveedor espec√≠fico" (asignaci√≥n autom√°tica)

    5. **Bug de alineaci√≥n de slots (resuelto 2025-11-19)**
       - Si est√°s consultando antes del horario de apertura, aseg√∫rate de tener la versi√≥n m√°s reciente del sistema

    <Tip>
    Usa el endpoint **GET /v1/operational-status** para verificar r√°pidamente si la cl√≠nica est√° abierta y por qu√©.
    </Tip>
  </Accordion>

  <Accordion title="El sistema no me deja agendar" icon="triangle-exclamation">
    **Errores comunes:**

    1. **"L√≠mite de plan alcanzado"**
       - Has alcanzado el l√≠mite de citas de tu plan de suscripci√≥n
       - Soluci√≥n: Haz upgrade a un plan superior en **Suscripci√≥n** > **Cambiar Plan**
       - Alternativa: Activa overage (cargos por cita extra) si tu plan lo soporta

    2. **"El horario solicitado no est√° disponible"**
       - Alguien m√°s agend√≥ mientras completabas el formulario
       - Soluci√≥n: Refresca la p√°gina y selecciona otro slot

    3. **"Recurso no disponible en ese horario"**
       - El servicio requiere un recurso espec√≠fico (ej: sala de operaciones) que est√° ocupado
       - Soluci√≥n: Selecciona otro horario o verifica disponibilidad del recurso

    4. **"Paciente ya tiene una cita en ese horario"**
       - El sistema previene dobles reservas para el mismo paciente
       - Soluci√≥n: Verifica las citas existentes del paciente en **Pacientes** > **Buscar**

    <Warning>
    Si el error persiste, contacta a soporte t√©cnico. Incluye:
    - Mensaje de error exacto
    - Fecha/hora que intentaste agendar
    - Servicio y proveedor seleccionados
    </Warning>
  </Accordion>

  <Accordion title="El tel√©fono no es v√°lido" icon="phone-xmark">
    **Error: "Invalid phone format"**

    El sistema requiere formato E.164: `+[c√≥digo pa√≠s][n√∫mero]`

    **Ejemplos correctos:**
    - ‚úÖ Espa√±a: `+34612345678`
    - ‚úÖ M√©xico: `+525512345678`
    - ‚úÖ Argentina: `+5491123456789`
    - ‚úÖ Colombia: `+573001234567`

    **Ejemplos incorrectos:**
    - ‚ùå `612345678` (falta c√≥digo pa√≠s)
    - ‚ùå `34612345678` (falta el `+`)
    - ‚ùå `+34 612 34 56 78` (tiene espacios)
    - ‚ùå `+34-612-345-678` (tiene guiones)

    **Soluci√≥n:**
    1. Elimina espacios, guiones, par√©ntesis
    2. Agrega `+` al inicio
    3. Agrega c√≥digo de pa√≠s (Espa√±a = 34)

    <Tip>
    Si no sabes el c√≥digo de pa√≠s, b√∫scalo en [c√≥digos de pa√≠s](https://countrycode.org/).
    </Tip>
  </Accordion>

  <Accordion title="El paciente no recibe notificaci√≥n WhatsApp" icon="message-xmark">
    **Posibles causas:**

    1. **WhatsApp no est√° activado en tu cl√≠nica**
       - Verifica en **Configuraci√≥n** > **WhatsApp**
       - Si est√° desactivado, act√≠valo siguiendo [Activar WhatsApp](/whatsapp/setup)

    2. **El n√∫mero no tiene WhatsApp**
       - Verifica que el n√∫mero tenga WhatsApp activo
       - Prueba enviando un mensaje de prueba desde tu tel√©fono

    3. **El n√∫mero est√° en formato incorrecto**
       - Verifica que usaste formato E.164 (`+34612345678`)

    4. **L√≠mite de mensajes excedido (Twilio)**
       - Si enviaste muchos mensajes en poco tiempo, Twilio puede limitar temporalmente
       - Espera 1 hora y prueba de nuevo

    5. **Per√≠odo de gracia expirado**
       - Twilio requiere que el paciente haya iniciado conversaci√≥n en las √∫ltimas 24 horas
       - Soluci√≥n: Pide al paciente que te env√≠e un mensaje primero ("Hola")

    <Note>
    Puedes verificar el estado de env√≠o en **Logs** > **WhatsApp Messages** (si tienes acceso).
    </Note>
  </Accordion>

  <Accordion title="La cita se cre√≥ duplicada" icon="copy">
    **¬øHiciste doble-click en "Agendar Cita"?**

    El sistema usa `idempotency_key` para prevenir duplicados, pero:
    - Si hiciste click muy r√°pido, pueden crearse 2 citas
    - Soluci√≥n: Cancela la cita duplicada en **Citas** > **Todas las Citas**

    <Tip>
    Evita hacer doble-click en el bot√≥n "Agendar Cita". Haz click una sola vez y espera el mensaje de confirmaci√≥n.
    </Tip>
  </Accordion>
</AccordionGroup>

---

## Pr√≥ximos Pasos

Ahora que sabes c√≥mo agendar citas manualmente, explora estas funcionalidades:

<CardGroup cols={2}>
  <Card title="Modificar Cita" icon="pen-to-square" href="/appointments/modify-appointment">
    Aprende a cambiar fecha, hora o servicio de una cita existente
  </Card>
  <Card title="Cancelar Cita" icon="circle-xmark" href="/appointments/cancel-appointment">
    Paso a paso para cancelar una cita y liberar el horario
  </Card>
  <Card title="Ver Calendario" icon="calendar" href="/appointments/view-calendar">
    Navega el calendario y filtra citas por proveedor, estado, etc.
  </Card>
  <Card title="Buscar por Paciente" icon="magnifying-glass" href="/appointments/search-patient">
    Encuentra todas las citas de un paciente espec√≠fico
  </Card>
</CardGroup>

---

## Mejores Pr√°cticas

<Tip>
**Confirma siempre por tel√©fono**: Aunque el sistema env√≠a notificaci√≥n WhatsApp, es buena pr√°ctica llamar al paciente 24h antes para confirmar. Esto reduce el no-show (pacientes que no llegan).
</Tip>

<Warning>
**No elimines citas**: En lugar de eliminar, usa "Cancelar Cita". Esto mantiene el historial para auditor√≠a, reportes, y an√°lisis de no-show.
</Warning>

<Note>
**Horarios de alta demanda**: Si tienes horarios muy solicitados (ej: viernes tarde), considera aumentar el `slot_step_min` para tener m√°s slots disponibles. Config√∫ralo en **Servicios** > **Duraci√≥n y Buffers**.
</Note>

<Info>
**Reagendar vs Cancelar + Crear**: Si un paciente quiere cambiar de fecha:
- Usa **Modificar Cita** (m√°s r√°pido, mantiene historial)
- NO canceles y crees una nueva (pierde el historial de cambios)
</Info>
